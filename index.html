<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Ciclo — Seguimiento</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
<header class="bar">
  <h1>Ciclo</h1>
  <div class="hstack">
    <button id="btnThree">3 meses</button>
    <button id="btnAdd" aria-label="Añadir registro">＋</button>
  </div>
</header>

<main class="container">
  <section class="stats" aria-label="Resumen">
    <div><strong>Promedio ciclo:</strong> <span id="avgCycle">—</span> d</div>
    <div><strong>Duración regla:</strong> <span id="avgBleed">—</span> d</div>
    <div><strong>Confianza:</strong> <span id="confidence">—</span></div>
    <div><strong>Próxima regla:</strong> <span id="nextPeriod">—</span></div>
  </section>

  <section class="panel" aria-label="Calendario">
    <div class="calendar-head">
      <button id="prev">◀</button>
      <h2 id="monthLabel"></h2>
      <button id="next">▶</button>
    </div>
    <div id="calWrap" class="cal-wrap"><!-- 1 o 3 meses --></div>
    <legend class="legend">
      <span class="dot dot-period"></span> Regla
      <span class="dot dot-fertile"></span> Ventana fértil
      <span class="dot dot-ov"></span> Ovulación
    </legend>
  </section>

  <section class="panel" aria-label="Próximas predicciones">
    <h3>Próximas fechas</h3>
    <div id="nextTable" class="table-like"></div>
  </section>

  <section class="panel" aria-label="Fases y consecuencias">
    <div class="phases">
      <article data-key="menstrual">
        <header>
          <h3>Fase menstrual</h3>
          <div class="tags"><span class="tag">D1–5</span></div>
          <button class="tiny edit-phase">Editar texto</button>
        </header>
        <p class="phase-text"></p>
      </article>
      <article data-key="folicular">
        <header>
          <h3>Fase folicular</h3>
          <div class="tags"><span class="tag">D1–13</span></div>
          <button class="tiny edit-phase">Editar texto</button>
        </header>
        <p class="phase-text"></p>
      </article>
      <article data-key="ovulacion">
        <header>
          <h3>Ovulación</h3>
          <div class="tags"><span class="tag">~D14</span></div>
          <button class="tiny edit-phase">Editar texto</button>
        </header>
        <p class="phase-text"></p>
      </article>
      <article data-key="lutea">
        <header>
          <h3>Fase lútea</h3>
          <div class="tags"><span class="tag">D15–28</span></div>
          <button class="tiny edit-phase">Editar texto</button>
        </header>
        <p class="phase-text"></p>
      </article>
    </div>
  </section>

  <section class="panel" aria-label="Historial">
    <h3>Historial de ciclos</h3>
    <div id="history"></div>
  </section>
</main>

<dialog id="dlg">
  <form id="formEntry" method="dialog">
    <h3 id="dlgTitle">Nuevo registro</h3>
    <input type="hidden" id="editIndex">
    <label>Inicio regla
      <input type="date" id="start" required>
    </label>
    <label>Duración (días)
      <input type="number" id="duration" min="1" max="10" value="5">
    </label>
    <label>Flujo
      <select id="flow">
        <option>ligero</option><option selected>medio</option><option>alto</option>
      </select>
    </label>
    <label>Dolor
      <select id="pain">
        <option>ninguno</option><option>leve</option><option>moderado</option><option>fuerte</option>
      </select>
    </label>
    <label>Estado de ánimo
      <input id="mood" placeholder="p. ej., irritable, estable">
    </label>
    <label>Notas
      <textarea id="notes" rows="3"></textarea>
    </label>
    <menu>
      <button value="cancel">Cancelar</button>
      <button id="save" value="default">Guardar</button>
    </menu>
  </form>
</dialog>

<dialog id="dlgSettings">
  <form method="dialog">
    <h3>Ajustes</h3>
    <label>Días fase lútea
      <input type="number" id="lutealDays" min="10" max="17" value="14">
    </label>
    <menu>
      <button value="cancel">Cerrar</button>
      <button id="saveSettings" value="default">Guardar</button>
    </menu>
  </form>
</dialog>

<dialog id="dlgPhase">
  <form method="dialog">
    <h3>Editar texto de fase</h3>
    <input type="hidden" id="phaseKey">
    <textarea id="phaseBody" rows="8"></textarea>
    <menu>
      <button value="cancel">Cancelar</button>
      <button id="savePhase" value="default">Guardar</button>
    </menu>
  </form>
</dialog>

<footer class="footer">
  <button id="btnExport">Exportar JSON</button>
  <button id="btnImport">Importar JSON</button>
  <button id="btnSettings">Ajustes</button>
</footer>

<script src="app.js"></script>
</body>
</html>
